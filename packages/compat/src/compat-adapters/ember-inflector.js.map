{"version":3,"file":"ember-inflector.js","sourceRoot":"","sources":["ember-inflector.ts"],"names":[],"mappings":";;;;;AAAA,2DAAkC;AAClC,iEAAuC;AAEvC,2BAAiD;AACjD,+BAA4B;AAC5B,uCAAsC;AACtC,oDAA4B;AAE5B,MAAM,gBAAgB,GAAG;;;;;;;;CAQxB,CAAC;AAEF,MAAM,KAAK,GAAG,+BAA+B,CAAC;AAE9C,eAAqB,SAAQ,kBAAO;IAClC,IAAI,MAAM;QACR,OAAO,IAAI,qBAAS,CAAC,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,EAAE;YAC7C,IAAI,MAAM,GAAG,IAAA,WAAI,EAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YACzC,IAAI,MAAM,GAAG,IAAA,iBAAY,EAAC,MAAM,CAAC,CAAC;YAClC,6DAA6D;YAC7D,qEAAqE;YACrE,IAAA,qBAAU,EAAC,MAAM,CAAC,CAAC;YACnB,IAAA,kBAAa,EAAC,MAAM,EAAE,KAAK,GAAG,MAAM,CAAC,CAAC;YACtC,IAAA,kBAAa,EAAC,IAAA,WAAI,EAAC,SAAS,EAAE,sBAAsB,CAAC,EAAE,gBAAgB,CAAC,CAAC;QAC3E,CAAC,CAAC,CAAC;IACL,CAAC;IAED,MAAM,CAAC,kBAAkB,CAAC,aAAkB;QAC1C,OAAO,gBAAM,CAAC,EAAE,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;IACvD,CAAC;CACF;AAhBD,4BAgBC","sourcesContent":["import V1Addon from '../v1-addon';\nimport AddToTree from '../add-to-tree';\nimport type { Node } from 'broccoli-node-api';\nimport { readFileSync, writeFileSync } from 'fs';\nimport { join } from 'path';\nimport { removeSync } from 'fs-extra';\nimport semver from 'semver';\n\nconst makeConfigurable = `\nif (EmberENV.EXTEND_PROTOTYPES === true || EmberENV.EXTEND_PROTOTYPES.String) {\n  Object.defineProperty(String.prototype, 'pluralize', { configurable: true });\n  Object.defineProperty(String.prototype, 'singularize', { configurable: true });\n  Object.defineProperty(Ember, 'Inflector', { configurable: true });\n  Object.defineProperty(Ember.String, 'singularize', { configurable: true });\n  Object.defineProperty(Ember.String, 'pluralize', { configurable: true });\n}\n`;\n\nconst patch = `import './make-configurable';`;\n\nexport default class extends V1Addon {\n  get v2Tree(): Node {\n    return new AddToTree(super.v2Tree, outputDir => {\n      let target = join(outputDir, 'index.js');\n      let source = readFileSync(target);\n      // we need to remove first because we might be dealing with a\n      // broccoli-produced symlink to a file we really don't want to alter.\n      removeSync(target);\n      writeFileSync(target, patch + source);\n      writeFileSync(join(outputDir, 'make-configurable.js'), makeConfigurable);\n    });\n  }\n\n  static shouldApplyAdapter(addonInstance: any) {\n    return semver.lt(addonInstance.pkg.version, '4.0.0');\n  }\n}\n"]}